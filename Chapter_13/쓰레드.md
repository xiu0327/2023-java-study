# 쓰레드
## 1. 프로세스와 쓰레드
- 프로세스 : 실행중인 프로그램
- 쓰레드 : 프로그램 내에서 일어나는 작업
- 프로세스는 프로그램을 수행하는 데 필요한 데이터, 메모리, 쓰레드로 구성됨
- 모든 프로세스에는 최소한 하나 이상의 쓰레드가 존재
- 멀티 쓰레드 프로세스 : 둘 이상의 쓰레드를 가진 프로세스
### 1.1 멀티태스킹과 멀티 쓰레딩
- 멀티태스킹 : 여러 개의 프로세스가 동시에 실행됨
- 멀티쓰레딩 : 하나의 프로세스 내에서 여러 쓰레드가 동시에 작업
- 프로세스의 성능이 단순히 쓰레드의 개수만으로 정해지는 것이 아니다. 하나의 쓰레드를 가진 프로세스보다 두 개의 쓰레드를 가진 프로세스가 오히려 더 낮은 성능을 보일 수 있다.
### 1.2 멀티쓰레딩의 장단점
- CPU의 사용률을 향상시킨다
- 자원을 보다 효율적으로 사용할 수 있다
- 사용자에 대한 응답성이 향상된다
- 작업이 분리되어 코드가 간결해진다.
- 동기화 문제
- 교착상태 문제
- 여러 사용자에게 서비스를 해주는 서버 프로그램의 경우 멀티쓰레드로 작성하는 것은 필수적
- 하나의 서버 프로세스가 여러 개의 쓰레드를 생성해서 쓰레드와 사용자의 요청이 일대일로 처리되도록 프로그래밍 해야함
## 2. 쓰레드의 구현과 실행 
### 2-1. Runnable 인터페이스
- 재사용이 높고 코드의 일관성을 유지할 수 있음
- Runnable 인터페이스를 구현한 클래스의 인터페이스를 생성한 다음, 인스턴스를 Thread 클래스의 생성자 매개변수로 제공해야 함
~~~java
Runnable runnable= new RunnablImpl();
Thread thread = new Thread(runnable);
~~~
- Runnable을 구현하면 Thread 클래스의 static 메서드인 currentThread()를 호출하여 메서드에 대한 참조를 얻어와야 호출이 가능하다.
### 2-2. Thread의 실행 - start
- 쓰레드를 실행했다고 해서 자동으로 실행되는 것은 아니다.
- start()를 호출해야만 쓰레드가 실행된다.
- start()를 호출해도 쓰레드가 바로 실행되는 것이 아닌, 실행 대기 상태에서 자신의 차례가 되어야 실행된다.
- 물론 실행대기중인 쓰레드가 하나도 없으면 곧바로 실행 상태가 된다.
- 한번 실행이 종료된 쓰레드는 다시 실행할 수 없다.
- 하나의 쓰레드에 대해 start()는 한번만 호출할 수 있다.
### 2-3. start()와 run()
- run() : 생성된 쓰레드를 실행하는 것이 아닌, 단순히 클래스에 선언된 메서드를 호출함
- start() : 새로운 쓰레드가 작업을 실행하는데 필요한 호출 스택 생성

### 2-4. main 쓰레드
- 프로그램이 실행되기 위해서는 작업을 수행하는 일꾼(쓰레드)가 최소한 하나는 필요하다.
- 프로그램을 실행하면 기본적으로 하나의 쓰레드를 생성하고, 그 쓰레드가 main 메서드를 호출해서 작업이 수행되도록 한다.
- main 메서드가 수행을 마쳤다 하더라도 다른 쓰레드가 아직 작업을 마치치 않은 상태라면 프로그램이 종료되지 않는다.
- 실행 중인 사용자 쓰레드가 하나도 없을 때, 프로그램은 종료된다.

## 3. 싱글쓰레드와 멀티쓰레드
- 싱글쓰레드
  - 하나의 쓰레드로 두 작업을 처리하는 경우엔 한 작업을 마친 후에 다른 작업을 시작
- 멀티쓰레드
  - 두 개의 쓰레드로 작업하는 경우 짧은 시간 동안 2개의 쓰레드가 번갈아가며 작업을 수행
- 멀티 쓰레드로 수행한 시간이 싱글 쓰레드보다 작업한 시간이 더 걸리게 되는데, 쓰레드간의 작업 전환에 시간이 많이 걸리기 때문이다.
- 싱글 코어에서 단순히 CPU만을 사용하는 계산작업이라면 오히려 멀티스레드보다 싱글쓰레드로 프로그래밍하는 것이 더 효율적
- 싱글 코어일 때, 멀티쓰레드라도 하나의 코어가 번갈아가면서 작업을 수행하므로 작업이 절대 겹치지 않는다.
- 멀티 코어에서는 멀티쓰레드로 두 작업을 수행하면 동시에 두 쓰레드가 수행될 수 있으므로 작업이 겹칠 수 있다. 
- JVM의 쓰레드 스케줄러에 의해 어떤 쓰레드가 얼마동안 실행될 것인지 결정되는 것과 같이 프로세스도 프로세스 스케줄러에 의해 실행순서와 실행시간이 결정되기 때문에 매 순간 상황에 따라 프로세스에게 할당되는 실행시간이 일정하지 않고 쓰레드에 할다되는 시간 역시 일정하지 않다.
- 두 쓰레드가 서로 다른 자원을 사용하는 작업의 경우, 싱글쓰레드 프로세스보다 멀티 쓰레드 프로세스가 효율적.
  - 사용자로부터 데이터를 입력받는 작업, 네트워크로 파일을 주고받는 작업, 프린터로 파일을 출력하는 작업 등
## 4. 쓰레드의 우선순위
- 시각적인 부분이나 사용자에게 빠르게 대응해야하는 작업을 하는 쓰레드의 우선순위는 다른 작업을 수행하는 쓰레드에 비해 높아야 한다.
- 쓰레드가 가질 수 있는 우선순위의 범위는 1~10이다.
- 숫자가 높을수록 우선순위가 높다.
- 쓰레드의 우선순위는 쓰레드를 생성한 쓰레드로부터 상속받는다.
  - main 메서드를 수행하는 쓰레드는 우선순위가 5이므로 main 메서드 내에서 생성하는 쓰레드의 우선순위는 자동적으로 5가 된다.
- 우선순위는 쓰레드를 실행하기 전에만 변경할 수 있다.
- 싱글 코어에서 우선순위가 높다면 더 많은 양의 실행시간이 주어지고 결과적으로 작업 A가 B보다 더 빨리 완료될 수 있다.
- 멀티코어에서는 쓰레드의 우선순위에 따른 차이가 없다. 